definition {

	macro addEVPSite {
		Site.openSitesAdmin();

		TeamExtranet.addSiteTemplateCP(
			siteName = "EVP Portal",
			siteTemplateName = "EVP");
	}

	macro assertCardsTitle {
		for (var cardTitle : list ${listcardTitle}) {
			AssertElementPresent(
				key_card = ${cardTitle},
				locator1 = "Card#CARD_TITLE");
		}
	}

	macro assertColumnsPage {
		for (var columnsPage : list ${columnsList}) {
			AssertElementPresent(
				key_columns = ${columnsPage},
				locator1 = "EVPUtils#REQUEST_COLUMNS");
		}
	}

	macro assertDataOnEVPValue {
		AssertVisible(
			key_text = "Years EVP has been active",
			key_value = ${yearsEVP},
			locator1 = "EVPUtils#DATA_ON_EVP_VALUE");

		AssertVisible(
			key_text = "Service Hours Completed",
			key_value = ${serviceHoursCompleted},
			locator1 = "EVPUtils#DATA_ON_EVP_VALUE");

		AssertVisible(
			key_text = "Grant Money Distributed",
			key_value = ${grantMoneyDistributed},
			locator1 = "EVPUtils#DATA_ON_EVP_VALUE");

		AssertVisible(
			key_text = "Number of nonprofits served",
			key_value = ${numberOfNonprofitsServed},
			locator1 = "EVPUtils#DATA_ON_EVP_VALUE");

		AssertVisible(
			key_text = "Employees that participated on EVP",
			key_value = ${employeesParticipated},
			locator1 = "EVPUtils#DATA_ON_EVP_VALUE");
	}

	macro assertHeadersTitle {
		for (var headerTitle : list ${listHeaderTitle}) {
			AssertElementPresent(
				key_title = ${headerTitle},
				locator1 = "Header#H4_TITLE");
		}
	}

	macro assertTitlePage {
		for (var titlePage : list ${listTitlePage}) {
			AssertElementPresent(
				key_title = ${titlePage},
				locator1 = "Header#H3_TITLE");
		}
	}

	macro changeStatus {
		Type(
			key_fieldId = "messageDescribed",
			locator1 = "TextArea#ANY_ID",
			value1 = ${typeMessage});

		Button.click(button = ${button});

		WaitForPageLoad();
	}

	macro downloadFileViaCurl {
		var currentURL = selenium.getCurrentUrl();
		var testDependenciesDir = PropsUtil.get("output.dir.name");

		var curl = '''${currentURL} --create-dirs -o ${testDependenciesDir}/${fileName}''';

		echo("curl = ${curl}");

		com.liferay.poshi.runner.util.JSONCurlUtil.get(${curl});
	}

	macro editObjectEVP {
		Type(
			key_fieldLabel = "Employees Participated EVP",
			locator1 = "TextInput#GENERIC_TEXT_INPUT",
			value1 = ${employeesParticipated});

		Type(
			key_fieldLabel = "Grant Money Distributed",
			locator1 = "TextInput#GENERIC_TEXT_INPUT",
			value1 = ${grantMoneyDistributed});

		Type(
			key_fieldLabel = "Number Of Nonprofits Served",
			locator1 = "TextInput#GENERIC_TEXT_INPUT",
			value1 = ${numberOfNonprofitsServed});

		Type(
			key_fieldLabel = "Service Hours Completed",
			locator1 = "TextInput#GENERIC_TEXT_INPUT",
			value1 = ${serviceHoursCompleted});

		Type(
			key_fieldLabel = "Years EVP",
			locator1 = "TextInput#GENERIC_TEXT_INPUT",
			value1 = ${yearsEVP});

		Button.clickSave();

		Alert.viewSuccessMessage();
	}

	macro generateFinancialReport {
		Click(
			key_card = ${cardTitle},
			locator1 = "Card#CARD_TITLE");

		EVPUtils.insertDate(
			dateRange = ${dateRange},
			endDateLabel = ${endDateLabel},
			initialDateLabel = ${initialDateLabel});

		Button.click(button = "Generate");
	}

	macro generateRequestsListing {
		Click(
			key_card = ${cardTitle},
			locator1 = "Card#CARD_TITLE");

		EVPUtils.insertDate(
			dateRange = ${dateRange},
			endDateLabel = ${endDateLabel},
			initialDateLabel = ${initialDateLabel});

		if (isSet(fullName)) {
			Type(
				key_fieldLabel = "Full Name",
				locator1 = "TextInput#GENERIC_TEXT_INPUT",
				value1 = ${fullName});
		}

		if (isSet(initialCompanyId)) {
			Type(
				inputFieldId = "initialCompanyId",
				locator1 = "TextInput#INPUT_ID",
				value1 = ${initialCompanyId});
		}

		if (isSet(finalCompanyId)) {
			Type(
				inputFieldId = "finalCompanyId",
				locator1 = "TextInput#INPUT_ID",
				value1 = ${finalCompanyId});
		}

		if (isSet(companyName)) {
			Type(
				key_fieldLabel = "Company Name",
				locator1 = "TextInput#GENERIC_TEXT_INPUT",
				value1 = ${companyName});
		}

		for (var checkboxName : list ${listCheckbox}) {
			Check.checkNotVisible(
				checkboxName = ${checkboxName},
				locator1 = "Checkbox#ANY_CHECKBOX");
		}

		Button.click(button = "Generate");
	}

	macro gotoEVP {
		Navigator.openSiteURL(siteName = "EVP Portal");

		if (IsElementPresent(locator1 = "EVPUtils#SIGN_IN")) {
			Click(locator1 = "EVPUtils#SIGN_IN");
		}
	}

	macro insertDate {
		var currentDate = DateUtil.getFormattedDate(${dateRange}, "yyyy-MM-dd");
		var nextDayDate = DateUtil.getFormattedDate("+2", "yyyy-MM-dd");

		Type.sendKeys(
			key_fieldLabel = ${initialDateLabel},
			locator1 = "TextInput#GENERIC_TEXT_INPUT",
			value1 = ${currentDate});

		Type.sendKeys(
			key_fieldLabel = ${endDateLabel},
			locator1 = "TextInput#GENERIC_TEXT_INPUT",
			value1 = ${nextDayDate});
	}

	macro viewStatus {
		AssertElementPresent(
			key_organizationName = ${organizationName},
			key_status = ${status},
			locator1 = "EVPUtils#STATUS_LISTING");
	}

	macro viewSuccessMessage {
		while (IsElementPresent(locator1 = "Message#EMPTY_INFO")) {
			AssertTextEquals(
				locator1 = "Message#EMPTY_INFO",
				value1 = "Thank you. Your information was successfully received.");
		}
	}

}